syntax = "proto3";

package grpc.auth;

option java_multiple_files = true;
option java_package = "com.proto.auth";
option java_outer_classname = "AuthProto";

// message Test de la validité d'une paire
// message Ajout d'une paire
// message Modification du mot de passe d'une paire
// message Suppression d'une paire
message Identite {
  string login = 2;
  string mdp = 1;
}

// enum des statuts de vérification
enum StatutVerificationPaire {
  GOOD = 0; // Réponse à vérification d'une paire
  BAD = 1; // Réponse à vérification d'une paire
}

// enum des statuts de vérification
enum StatutVerificationOpe {
  ERROR = 0; // Compte rendu négatif
  DONE = 3; // Compte rendu positif d’opération (ADD, DEL ou MOD)
  MOD = 4; // modifier
  DEL = 5; //supprimer
  ADD = 6; //ajouter
}

// message Réponse positive de validation
// message Réponse négative de validation
message StatutPaire {
  StatutVerificationPaire statut = 1;
}

// message Réponse positive d'ajout, modification ou suppression
message StatutOpe {
  StatutVerificationOpe statut = 1;
}

//Services
// Service Manager
service ASManager {
  rpc Verifier(Identite) returns (StatutPaire);
  rpc Ajouter(Identite) returns (StatutOpe);
  rpc Supprimer(Identite) returns (StatutOpe);
  rpc ModifierMotDePasse(Identite) returns (StatutOpe);
}

// Service Checker
service ASChecker {
  rpc Verifier(Identite) returns (StatutPaire);
}

// Journalisation
message LogRequest {
  string req = 1; // avec l'enum
  string login = 2;
  string resultat = 3; // avec l'enum
  string client = 4;
  string heure = 5;
}

message Empty {} // Réponse vide

service LoggingService {
  rpc log(LogRequest) returns (Empty);
}